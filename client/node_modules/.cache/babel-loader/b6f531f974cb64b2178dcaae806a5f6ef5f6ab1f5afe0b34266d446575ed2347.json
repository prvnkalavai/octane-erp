{"ast":null,"code":"import * as log from '../log';\nimport { isHConcatSpec, isVConcatSpec } from '../spec';\nimport { keys } from '../util';\nimport { buildModel } from './buildmodel';\nimport { parseData } from './data/parse';\nimport { assembleLayoutSignals } from './layoutsize/assemble';\nimport { parseConcatLayoutSize } from './layoutsize/parse';\nimport { Model } from './model';\nimport { MULTI_VIEW_ANIMATION_UNSUPPORTED } from '../log/message';\nimport { isTimerSelection } from './selection';\nexport class ConcatModel extends Model {\n  constructor(spec, parent, parentGivenName, config) {\n    super(spec, 'concat', parent, parentGivenName, config, spec.resolve);\n    if (spec.resolve?.axis?.x === 'shared' || spec.resolve?.axis?.y === 'shared') {\n      log.warn(log.message.CONCAT_CANNOT_SHARE_AXIS);\n    }\n    this.children = this.getChildren(spec).map((child, i) => {\n      return buildModel(child, this, this.getName(`concat_${i}`), undefined, config);\n    });\n  }\n  parseData() {\n    this.component.data = parseData(this);\n    for (const child of this.children) {\n      child.parseData();\n    }\n  }\n  parseSelections() {\n    // Merge selections up the hierarchy so that they may be referenced\n    // across unit specs. Persist their definitions within each child\n    // to assemble signals which remain within output Vega unit groups.\n    this.component.selection = {};\n    for (const child of this.children) {\n      child.parseSelections();\n      for (const key of keys(child.component.selection)) {\n        this.component.selection[key] = child.component.selection[key];\n      }\n    }\n    if (Object.values(this.component.selection).some(selCmpt => isTimerSelection(selCmpt))) {\n      log.error(MULTI_VIEW_ANIMATION_UNSUPPORTED);\n    }\n  }\n  parseMarkGroup() {\n    for (const child of this.children) {\n      child.parseMarkGroup();\n    }\n  }\n  parseAxesAndHeaders() {\n    for (const child of this.children) {\n      child.parseAxesAndHeaders();\n    }\n    // TODO(#2415): support shared axes\n  }\n  getChildren(spec) {\n    if (isVConcatSpec(spec)) {\n      return spec.vconcat;\n    } else if (isHConcatSpec(spec)) {\n      return spec.hconcat;\n    }\n    return spec.concat;\n  }\n  parseLayoutSize() {\n    parseConcatLayoutSize(this);\n  }\n  parseAxisGroup() {\n    return null;\n  }\n  assembleSelectionTopLevelSignals(signals) {\n    return this.children.reduce((sg, child) => child.assembleSelectionTopLevelSignals(sg), signals);\n  }\n  assembleSignals() {\n    this.children.forEach(child => child.assembleSignals());\n    return [];\n  }\n  assembleLayoutSignals() {\n    const layoutSignals = assembleLayoutSignals(this);\n    for (const child of this.children) {\n      layoutSignals.push(...child.assembleLayoutSignals());\n    }\n    return layoutSignals;\n  }\n  assembleSelectionData(data) {\n    return this.children.reduce((db, child) => child.assembleSelectionData(db), data);\n  }\n  assembleMarks() {\n    // only children have marks\n    return this.children.map(child => {\n      const title = child.assembleTitle();\n      const style = child.assembleGroupStyle();\n      const encodeEntry = child.assembleGroupEncodeEntry(false);\n      return {\n        type: 'group',\n        name: child.getName('group'),\n        ...(title ? {\n          title\n        } : {}),\n        ...(style ? {\n          style\n        } : {}),\n        ...(encodeEntry ? {\n          encode: {\n            update: encodeEntry\n          }\n        } : {}),\n        ...child.assembleGroup()\n      };\n    });\n  }\n  assembleGroupStyle() {\n    return undefined;\n  }\n  assembleDefaultLayout() {\n    const columns = this.layout.columns;\n    return {\n      ...(columns != null ? {\n        columns\n      } : {}),\n      bounds: 'full',\n      // Use align each so it can work with multiple plots with different size\n      align: 'each'\n    };\n  }\n}","map":{"version":3,"names":["log","isHConcatSpec","isVConcatSpec","keys","buildModel","parseData","assembleLayoutSignals","parseConcatLayoutSize","Model","MULTI_VIEW_ANIMATION_UNSUPPORTED","isTimerSelection","ConcatModel","constructor","spec","parent","parentGivenName","config","resolve","axis","x","y","warn","message","CONCAT_CANNOT_SHARE_AXIS","children","getChildren","map","child","i","getName","undefined","component","data","parseSelections","selection","key","Object","values","some","selCmpt","error","parseMarkGroup","parseAxesAndHeaders","vconcat","hconcat","concat","parseLayoutSize","parseAxisGroup","assembleSelectionTopLevelSignals","signals","reduce","sg","assembleSignals","forEach","layoutSignals","push","assembleSelectionData","db","assembleMarks","title","assembleTitle","style","assembleGroupStyle","encodeEntry","assembleGroupEncodeEntry","type","name","encode","update","assembleGroup","assembleDefaultLayout","columns","layout","bounds","align"],"sources":["C:\\Users\\prave\\Repos\\octane-erp\\client\\node_modules\\vega-lite\\src\\compile\\concat.ts"],"sourcesContent":["import {NewSignal, SignalRef} from 'vega';\nimport {Config} from '../config';\nimport * as log from '../log';\nimport {isHConcatSpec, isVConcatSpec, NormalizedConcatSpec, NormalizedSpec} from '../spec';\nimport {keys} from '../util';\nimport {VgData, VgLayout} from '../vega.schema';\nimport {buildModel} from './buildmodel';\nimport {parseData} from './data/parse';\nimport {assembleLayoutSignals} from './layoutsize/assemble';\nimport {parseConcatLayoutSize} from './layoutsize/parse';\nimport {Model} from './model';\nimport {MULTI_VIEW_ANIMATION_UNSUPPORTED} from '../log/message';\nimport {isTimerSelection} from './selection';\n\nexport class ConcatModel extends Model {\n  public readonly children: Model[];\n\n  constructor(spec: NormalizedConcatSpec, parent: Model, parentGivenName: string, config: Config<SignalRef>) {\n    super(spec, 'concat', parent, parentGivenName, config, spec.resolve);\n\n    if (spec.resolve?.axis?.x === 'shared' || spec.resolve?.axis?.y === 'shared') {\n      log.warn(log.message.CONCAT_CANNOT_SHARE_AXIS);\n    }\n\n    this.children = this.getChildren(spec).map((child, i) => {\n      return buildModel(child, this, this.getName(`concat_${i}`), undefined, config);\n    });\n  }\n\n  public parseData() {\n    this.component.data = parseData(this);\n    for (const child of this.children) {\n      child.parseData();\n    }\n  }\n\n  public parseSelections() {\n    // Merge selections up the hierarchy so that they may be referenced\n    // across unit specs. Persist their definitions within each child\n    // to assemble signals which remain within output Vega unit groups.\n    this.component.selection = {};\n    for (const child of this.children) {\n      child.parseSelections();\n      for (const key of keys(child.component.selection)) {\n        this.component.selection[key] = child.component.selection[key];\n      }\n    }\n\n    if (Object.values(this.component.selection).some(selCmpt => isTimerSelection(selCmpt))) {\n      log.error(MULTI_VIEW_ANIMATION_UNSUPPORTED);\n    }\n  }\n\n  public parseMarkGroup() {\n    for (const child of this.children) {\n      child.parseMarkGroup();\n    }\n  }\n\n  public parseAxesAndHeaders() {\n    for (const child of this.children) {\n      child.parseAxesAndHeaders();\n    }\n\n    // TODO(#2415): support shared axes\n  }\n\n  private getChildren(spec: NormalizedConcatSpec): NormalizedSpec[] {\n    if (isVConcatSpec(spec)) {\n      return spec.vconcat;\n    } else if (isHConcatSpec(spec)) {\n      return spec.hconcat;\n    }\n    return spec.concat;\n  }\n\n  public parseLayoutSize() {\n    parseConcatLayoutSize(this);\n  }\n\n  public parseAxisGroup(): void {\n    return null;\n  }\n\n  public assembleSelectionTopLevelSignals(signals: NewSignal[]): NewSignal[] {\n    return this.children.reduce((sg, child) => child.assembleSelectionTopLevelSignals(sg), signals);\n  }\n\n  public assembleSignals(): NewSignal[] {\n    this.children.forEach(child => child.assembleSignals());\n    return [];\n  }\n\n  public assembleLayoutSignals(): NewSignal[] {\n    const layoutSignals = assembleLayoutSignals(this);\n\n    for (const child of this.children) {\n      layoutSignals.push(...child.assembleLayoutSignals());\n    }\n\n    return layoutSignals;\n  }\n\n  public assembleSelectionData(data: readonly VgData[]): readonly VgData[] {\n    return this.children.reduce((db, child) => child.assembleSelectionData(db), data);\n  }\n\n  public assembleMarks(): any[] {\n    // only children have marks\n    return this.children.map(child => {\n      const title = child.assembleTitle();\n      const style = child.assembleGroupStyle();\n      const encodeEntry = child.assembleGroupEncodeEntry(false);\n\n      return {\n        type: 'group',\n        name: child.getName('group'),\n        ...(title ? {title} : {}),\n        ...(style ? {style} : {}),\n        ...(encodeEntry ? {encode: {update: encodeEntry}} : {}),\n        ...child.assembleGroup()\n      };\n    });\n  }\n\n  public assembleGroupStyle(): string | string[] {\n    return undefined;\n  }\n\n  protected assembleDefaultLayout(): VgLayout {\n    const columns = this.layout.columns;\n    return {\n      ...(columns != null ? {columns} : {}),\n      bounds: 'full',\n      // Use align each so it can work with multiple plots with different size\n      align: 'each'\n    };\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}